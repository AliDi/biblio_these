\documentclass[fontsize=12pt,DIV13,paper=a4,abstract=true,titlepage=false]{scrartcl}
% KOMA Script is used for BeBeC template
% KOMA is part ofmost LaTeX installations.It can be downloaded from
% http://www.ctan.org/tex-archive/macros/latex/contrib/koma-script/
% Manual is generally located under /usr/share/texmf/doc/latex/koma-script/scrguide.pdf
\usepackage{scrpage2} % Part of KOMA: Control of format, header, and footer
%\usepackage{fancyhdr}  % Alternative to scrpage2 if KOMA is not used
\usepackage{amsmath}  % extended math
\usepackage{amssymb}  % more symbols
\usepackage{mathptmx} % provide times
\usepackage[scaled=.90]{helvet} % provide helvetica font
\usepackage{courier}  % replace computer modern teletype (cmtt) by courier font
\usepackage{upgreek} % provide upright greek characters, e.g. $\uppi$
\usepackage{color} % permits to print paper number over BeBeC logo

\KOMAoptions{DIV=last} % recalculate pagestyle for new font
\usepackage{setspace} % provides environment 'spacing' for interleaf change

% make LaTeX understand utf8 or UNICODE (e.g. use of German Umlaute, French accents,
%   Scandinavian and Czech Letters)
\usepackage[utf8x]{inputenc}% make LaTeX understand utf8
\usepackage[square,comma,sort&compress,numbers]{natbib}
%
\usepackage{graphicx} % leave filename extension .eps .jpg .png away
\usepackage{epstopdf} % converts eps-figures to pdf automatically for use with pdflatex

% Provide language specifics like hyphenation
\usepackage[ngerman,UKenglish,USenglish]{babel} % last language is default
% Language can be switched in text
%\selectlanguage{UKenglish} % provides hyphenation for UK English
%\selectlanguage{USenglish} % provides hyphenation for American English
%\selectlanguage{ngerman} % provides hyphenation for German words (new rules)

% % The following packages may be used in addition
\usepackage{float} % incorporates style option [H] which means
%      PUT IT HERE' (as opposed to the standard [h] option which means
%     `You may put it here if you like').
% \usepackage{picinpar} % wrap figures with text
% \usepackage{wrapfig}  % wrap figures/tables in text (i.e., Di Vinci style)
% \usepackage{verbatim}
% \usepackage{fancyvrb}%  extended verbatim environments
% \usepackage[font=it]{caption} % control caption appearance
% \usepackage{floatflt}
% \usepackage{varioref}%  smart page, figure, table, and equation referencing
% \usepackage{threeparttable}% tables with footnotes
% \usepackage{dcolumn}%   decimal-aligned tabular math columns \newcolumntype{d}{D{.}{.}{-1}}
% \usepackage{subfigure}% subcaptions for subfigures
% \usepackage{subfigmat}% matrices of similar subfigures, aka small multiples
% \fvset{fontsize=\footnotesize,xleftmargin=2em}
% \usepackage{placeins}   % provides \FloatBarrier
\usepackage[below]{placeins} % allow floats to be in the next section
% \usepackage{afterpage}
% \usepackage{multicol}
% \usepackage{morefloats}
% \usepackage{threeparttable} % tables with footnotes
% \usepackage{subfigure} % subcaptions for subfigures
 \usepackage{subfigmat} % matrices of similar subfigures, aka small multiples
% \fvset{fontsize=\footnotesize,xleftmargin=2em}

% Alter some LaTeX defaults for better treatment of figures:
    % See p.105 of "TeX Unbound" for suggested values.
    % See pp. 199-200 of Lamport's "LaTeX" book for details.
    %   General parameters, for ALL pages:
    \renewcommand{\topfraction}{0.9}  % max fraction of floats at top
    \renewcommand{\bottomfraction}{0.8} % max fraction of floats at bottom
%   \renewcommand{\textfraction}{0.07}  % allow minimal text w. figs
    \renewcommand{\textfraction}{0.0}
    \renewcommand{\topfraction}{1.0}
%   Parameters for FLOAT pages (not text pages):
%   \renewcommand{\floatpagefraction}{0.8}      % require fuller float pages
    \renewcommand{\floatpagefraction}{0.95}
% N.B.: floatpagefraction MUST be less than topfraction !!
%   \renewcommand{\dblfloatpagefraction}{0.8}   % require fuller float pages
%  remember to use [htp] or [htpb] for placement

% In case the spacing between lines needs to be smaller
\renewcommand{\baselinestretch}{0.95}
\sloppy
%   This declaration makes TeX less fussy about line breaking. This can
%   prevent overfull boxes, but may leave too much space between words.
%   Lasts until a `\fussy' command is issued. Usually, only those paragraphs
%   need to be enclosed in \sloppy and \fuzzy in which lines become too long.

\usepackage[pdftex,bookmarks=true,bookmarksnumbered=true,bookmarksopen=true,hypertexnames=false,breaklinks=true]{hyperref} % This produses a pdf in which you can jump to links

\addto{\captionsenglish}{% This line required when package babel used
\renewcommand*{\abstractname}{ABSTRACT}
} % This line required when babel package loaded

% \addtokomafont{section}{\sffamily} % is default in KOMA
\addtokomafont{caption}{\itshape} % captions italic
\addtokomafont{captionlabel}{\itshape} % captions italic
\addtokomafont{section}{\large}
\addtokomafont{subsection}{\normalsize}

% Prerender nonstandard letters of utf8 font
\PrerenderUnicode{äöüÄÖÜßéè}
\areaset{16cm}{22.2cm}
\recalctypearea
\headsep = 15mm
% The purpose of the large bottom margin is that copies can be
% made on US Letter paper, which has a smaller vertical size than A4.
%\setkomafont{title}{\sffamily\bfseries}

% Only sections and subsections shall get numbers
\setcounter{secnumdepth}{2}

\newcommand{\bo}[1]{ \mathbf{#1} }

%pour les plots matlab en tikz
\usepackage{pgfplots} 
\pgfplotsset{compat=newest}



\begin{document}
%\thispagestyle{scrplain} % automatically performed by KOMA

% file mytitle.tex contains the title matter
\def\papernumber{BeBeC-2018-XX}
% Please replace the last two digits by number assigned to your paper.
\title{%
\vspace{-30mm} % move logo obove typearea
\includegraphics[width=50mm]{logo_BeBeC_lrg_CMYK}\\
\null\vspace{-54mm}
% Paper number (assigned in acceptance Email)
{\hfill\large{\papernumber}}\\
\vspace{45mm}
%\null\box0 % typeset paper number
\Large{
ON THE DENOISING OF CROSS-SPECTRAL MATRICES FOR (AERO)ACOUSTIC APPLICATIONS
}}

\author{
% KOMA Standard would be:
%  Peter Sciman\thanks{German Aerospace Center, Müller-Breslau-Str. 8, 10623 Berlin, Germany,
% peter.science@dlr.de}
% \and Sarah Techwoman\thanks{Technical University of Berlin, Straße des 17.~Juni 135,
% 10623 Berlin, Germany, sarah.technology@tu-berlin.de}
% Word template is better approximated by
 \normalsize{Alice Dinsenmeyer$^1$, Jérôme Antoni$^1$, Quentin Leclère$^1$ and  Antonio Pereira$^2$}\\[-0.4em]
 \small{$^1$ Laboratoire Vibrations Acoustique}\\[-0.4em]
 \small{Univ Lyon, INSA-Lyon, LVA EA677, F-69621 Villeurbanne, France}\\[-0.4em]
 \small{$^2$ Laboratoire de Mécanique des Fluides et d’Acoustique }\\[-0.4em]
 \small{Univ Lyon, École Centrale de Lyon, F-69134, Écully, France}
\date{}
}

%\begin{spacing}{0.6}
\maketitle
%\end{spacing}

\begin{abstract}
Array systems and multichannel pressure measurements are widely used for source localization and quantification. Measurement noise such as calibration, electronic or ambient noise affects the performance of acoustic imaging algorithms. In aeroacoustic applications, acoustic pressure measurements can be highly disturbed by the presence of flow-induced noise \citep{Fenech2009}. However, signals are supposed to be stationnary and performing averaging of cross-spectral quantities over several time snapshots will concentrate uncorrelated noise along the diagonal of the cross-spectral matrix (CSM). A common practice is thus to set the diagonal of the CSM to zero, which is known to improve the dynamic range of the source localization maps, yet this also leads to underestimated source levels \citep{Dougherty2002a}. More advanced techniques have been recently developped to avoid such problems by preserving or reconstructing source information that lies in the CSM diagonal \citep{dougherty2016,Hald2017}.



Several existing approaches for CSM denoising are investigated in this paper and some new ones are proposed as well. We consider an unknown number of uncorrelated sources and no reference background noise. New methods are proposed based on the decomposition of the CSM into a low-rank part and a residual diagonal part attached to the unwanted noise; the corresponding inference problem is set up within a probabilistic framework which is ideally suited to take the non-deterministic nature of the estimated CSM into account. This is then solved by computing the maximum aposteriori estimates of the decomposition by using an expectation-maximization algorithm or by estimating the full aposteriori probability distribution by running a Markov chain Monte Carlo. For each method, reconstruction errors and convergence are compared in the frame of various numerical experiments, for different acoustic signals and noise structures.

\end{abstract}

\pagestyle{scrheadings}
% Place headers on the inner and outer sides of the header line
% \ihead and \ohead are from the KOMA script
\ihead{7\textsuperscript{th} Berlin Beamforming Conference 2018}

\section{Numerical experiments}

\subsection{Simulation of CSM}
Source spectra are generated randomly  :
\begin{equation}
	\bo{c}\sim \mathcal{N}(0,\frac{c_{rms}}{\sqrt{2}})
\end{equation}
where $c_{rms}$ stands for the root mean squared value of the spectra chosen equal to one for all the monopoles.\\

The propagator $\bo{H}$ is the Green functions for free field monopoles : 
\begin{equation}
	\bo{H}=\frac{e^{j k \bo{r}}}{4 \pi \bo{r}}
\end{equation}
k being the wavenumber and $\bo{r}$ distances between sources and receivers.\\

The acoustic signal is obtained from source propagation : \\
\begin{equation}
    \bo{a} = \bo{Hc}
\end{equation}
and a Gaussian noise is added : 
\begin{equation}
    \bo{p} = \bo{a} + \bo{n}
\end{equation}
with
\begin{equation}
    \bo{n}\sim \mathcal{N}(0,\frac{n_{rms}}{\sqrt{2}})
\end{equation}
where $n_{rms}=\langle \bo{a} \rangle_M \times 10^{-SNR/20}$ and $\langle \bullet \rangle$ is the average value over the M receivers.\\

Finally, cross-spectra are calculated : 
\begin{align}
% \bo{S}_{cc} &=\frac{1}{N_s}\bo{cc'}~~~\text{(sources)}\\
\bo{S}_{aa} &= \frac{1}{N_s}\bo{aa'}~~~\text{used as the refence signal for denoising,}\\
%\bo{S_n} &=\frac{1}{N_s}\bo{nn'}~~~\text{}\\
\bo{S}_{pp} &= \frac{1}{N_s}\bo{pp'}~~~\text{ which is the measurement spectrum to be denoised.}
\end{align}


\subsection{Configuration of the simulated acoustical propagation}
The acoustical field produced by a line of $K$ uncorrelated monopoles is measured by $M=93$ receivers  distributed as a spiral.
Default values for each parameter are given by the table~\ref{default_values}.
\begin{table}[H]
	\centering
	\begin{tabular}{c|c|c}
		\textbf{Parameter} & \textbf{Notation} & \textbf{Default value}\\\hline
		Frequency	&	$f$ 	&	15 kHz\\ \hline
		Number of monopoles	&	$K$	&	20\\ \hline
		Number of receivers	&	$M$ 	&	93\\ \hline
		SNR	&	$SNR$	&	10 dB\\ \hline
		Number of snapshots	&	$N_s$	&	10\textsuperscript{4}
	\end{tabular}
	\caption{Default values for the numerical simulations. \label{default_values}}

\end{table}

\begin{figure}[H]
	\centering
	\input{img/config.tex}
	\caption{Receiver and source positions used for acoustic field simulation (source line is tilted of 1 degree from the vertical to break antenna symmetry).}
\end{figure}


\section{Diagonal reconstruction}
In this section, three methods for diagonal reconstruction are presented. The idea of these method is to reduce as much as possible the self-induced noise concentrated on the diagonal elements of the CSM. The diagonale is minimized as long as the denoised CSM stay positive semidefinite. This problem can be written as : 
\begin{equation}
    \text{maximize~} \sum_i D_{ii} \text{~~subject to~~} \bo{S}_{pp}-\bo{D}\geq 0
\end{equation}
$\bo{D}$ being a diagonal matrix.\\

 \subsection{Convex optimization}
 Hald use sconvex programming with the CVX toolbox \cite{cvx,Grant_cvx} to solve this problem \cite{Hald2017}.

\subsection{Linear optimization}
Dougherty express this problem as a linear programming problem :
\begin{equation}
	\begin{aligned}
        		\text{maximize~} \sum_i D_{ii} \text{~~subject to~~}  \bo{V}^{i-1} \left( \bo{S}_{pp}-\bo{D}^i \right) \bo{V}^{i-1} \geq 0 
	\end{aligned}
\end{equation}
where $\bo{V}^{i-1}$ are the eigenvectors of $\bo{S}_{pp}-\bo{D}^{i-1} $.
 
 \subsection{Alternating projections}
Alternating projections method can also be used. The solution is the intersection between two sets : the first set is the positive semi-definite matrices and the second is the set of diagonal matrices for the noise matrix : 
\begin{equation}
	\begin{aligned}
		    &\bar{\bo{S}}_{pp}^0 = \bo{S}_{pp}-\operatorname{diagonal}(\bo{S}_{pp})\\
		    &\textbf{for~} i\\
		    & \qquad  \bo{s}^i = \operatorname{eigenvalues}(\bo{S}_{pp}^i)\\
		    & \qquad \bo{V}^i = \operatorname{eigenvectors}(\bo{S}_{pp}^i)\\
		   & \qquad \bo{s}^i(s \leq 0) = 0\\
		   & \qquad \bar{\bo{S}}_{pp}^{i+1} = \bar{\bo{S}}_{pp}^0 + \bo{V}^{i}{'}\bo{s}^i\bo{V}^i \\
		   &\textbf{endfor}
	\end{aligned}
\end{equation}
This algorithm stops when all the eigenvalues of the denoised CSM are nonnegative.

\subsection{Comparison of diagonal reconstruction methods}
For each of these methods, we study the relative error of the estimated signal spectra $\hat{\bo{S}}_{aa}$ defined as : 
\begin{equation}
    err = \frac{\| \operatorname{diag}(\bo{S}_{aa} ) - \operatorname{diag}(\hat{\bo{S}}_{aa})\|_2}{\|\operatorname{diag}(\bo{S}_{aa} ) \|_2}
\end{equation}
$\|\bullet\|$ being the $L_2$ norm. For each method, three parameters are successively changed : 
\begin{itemize}
    \item rank of signal matrix $\bo{S}_{aa}$ by increasing the number of monopoles from 1 to $M$,
    \item SNR from -10 to 10 dB,
    \item number of snapshots $N_s$.
\end{itemize}
When one parameter is changed, the others are constant, given by the table~\ref{default_values}.\\

\subsubsection{Rank of $\bo{S}_{aa}$}


\begin{figure}
	\hspace{-0.1\textwidth}
	\begin{minipage}{1.2\textwidth}
		\centering
		\input{img/diagonal_reconstruction/AP_rang.tex}
		\hspace{-0.2cm}\input{img/diagonal_reconstruction/AP_SNR.tex}
		\hspace{-0.3cm}\input{img/diagonal_reconstruction/AP_Mw.tex} \hfill\\
		\tikz[baseline]{\draw[dashed,line width=1.0pt] (0,.5ex)--++(.5,0) ;} Hald, 
		\tikz[baseline]{\draw[dotted,line width=1.0pt] (0,.5ex)--++(.5,0) ;} Alternating projections, 
		\tikz[baseline]{\draw[dash dot,line width=1.0pt] (0,.5ex)--++(.5,0) ;} Dougherty\\
	\end{minipage}
	\caption{ Error on the reconstructed diagonal, for different simulation parameters. On the right, error is plotted for 20, 80 and 93 sources.}
\end{figure}











%---------------------------------------------------------------------------------------------------------------------------------------------

% The following Bibstyle includes the ISBN numbers of the references
%\bibliographystyle{is-plain}
\bibliographystyle{bebec}
\bibliography{biblio}
% More than one bibtex file can be referenced here, e.g.
% \bibliography{array-lit,lit-beamforming,myliterature}


\end{document}
