\documentclass[8pt,xcolor=x11names,compress, notes=show]{beamer}% pour l'impression, tout n'apparait qu'une fois \documentclass[handout,12pt]{beamer}

%\usepackage[scaled]{helvet}
\usepackage[round]{natbib}
\usepackage[utf8x]{inputenc}
%\usepackage{ucs}
\usepackage[USenglish]{babel}
\usepackage{todonotes}
\usepackage{color}
%\usepackage{subfigure}
%\usepackage[]{geometry}
\usepackage{changepage}
\usepackage{pifont} %pour les symbole sympa \ding{nb}

% Pour Tikz
\usepackage{tikz}
\usetikzlibrary{calc}
%\usetikzlibrary{arrows,shapes,trees,positioning}  

%pour les plots matlab en tikz
\usepackage{pgfplots} 
\pgfplotsset{compat=newest}

% Pour les maths
\usepackage{bm}
\usepackage{amsmath,mathtools}
\usefonttheme[onlymath]{serif}
\usepackage{cancel} %pour barrer des math

% Pour la mise en forme
\usepackage[export]{adjustbox}
\usepackage{subcaption}
\usepackage{wrapfig}
\usepackage{pdfpages}
\setbeamertemplate{navigation symbols}{} 
\usepackage{array}
%\usepackage{palatino}
%\setbeamertemplate{caption}{\raggedright\insertcaption\par}
\usepackage{multicol}
\setlength{\columnsep}{0cm}
\usepackage[framemethod=TikZ]{mdframed}

%pour le theme
\usetheme{Alice}

%\useoutertheme[subsection=false]{miniframes} %%pour avoir le défilement en en-tête des diapos par section
%\setbeamercolor*{lower separation line head}{bg=DeepSkyBlue4} 

% Customisation 
\setlength{\fboxrule}{0.2pt}
\definecolor{green}{rgb}{0,0.5,0} 
\newcommand{\diag}[1]{\operatorname{diag}\left(#1\right)}
\newcommand{\tikzmark}[1]{\tikz[remember picture] \coordinate (#1) ++ (-3pt,6pt) {};}
\newcommand{\citeTransp}[1]{\color{fg!50} \citep{#1}}


%%% Page de titre
%======================
\author{\underline{A. {Dinsenmeyer}}$^{1,2}$, J. {Antoni}$^1$, Q. {Leclère}$^1$ and A. Pereira$^2$}
\institute{$^1$ Laboratoire Vibrations Acoustique\\ $^2$ Laboratoire de Mécanique des Fluides et d’Acoustique\\Lyon, France}
\title{On the Denoising of Cross-Spectral Matrices for (Aero)Acoustic Applications}
\subtitle{}
\date{\small March 5, 2018 -- 7\textsuperscript{th} BeBeC}
\titlegraphic{\vfill \includegraphics[height=1cm]{img/logo/celya-XL.png} \hfill  \includegraphics[height=1cm]{img/logo/logo_lmfa.pdf} \hfill \includegraphics[height=1cm]{img/logo/LVA_compact_couleur_transparent.png} \hfill   \includegraphics[height=1cm]{img/logo/logo_ADAPT.png} }

\begin{document}

%%%		Title
%======================
\begin{frame}[plain,t]
	\maketitle	
\end{frame}

%%% Context
%======================
\section*{Context}
\begin{frame}[t]{\insertsectionhead}
 	\begin{overprint}
	
		\begin{itemize}
			\item<1-> Unwanted random noise:
			\begin{itemize}
				\item electronic, ambient, flow-induced,...\\[3pt]
				\item short correlation lengths
			\end{itemize}
			\vspace{1cm}
			\item<2-> Existing denoising methods:
			
			\begin{itemize}
			        \item<3-> Physical removal : mic recession, porous treatment, vibrating structure filtering\dots\\[3pt]
			        \item<4->  Use a background noise measurement, $\rightarrow$ not always available or representative\\[3pt]
			        \item<5-> Wavenumber filtering\\[3pt]
			        \item<6-> Diagonal removal $\rightarrow$ underestimation of source level\\[3pt]
			        \only<7>{\item   Exploit noise/signal properties \& solve an optimization problem}
			        \onslide<8->{\item \fcolorbox{black}{white}{ Exploit noise/signal properties \& solve an optimization problem}}
			\end{itemize}
			%Use spatial properties of signal and noise to separate them.
		\end{itemize}
	
	\end{overprint}
	
	\onslide<1->{
	%\begin{picture}(0,0)(0,0)\put(200,125){	
	\begin{tikzpicture}[remember picture, overlay]
			\node[yshift=-2cm,xshift=-3cm] (a) at (current page.north east) {\includegraphics[width=3cm]{img/bruit.png}};
	\end{tikzpicture}
	%}\end{picture}
	}

\end{frame}



%%% CSM properties
%======================
%\section{CSM properties}
\begin{frame}[t]{\insertsectionhead~--~CSM properties}
	\begin{overlayarea}{\textwidth}{1.8cm}
	\only<1>{
	$$\underbracket[0.5pt]{~\bm{p}~}_{\text{measured spectra}} =\underbracket[0.5pt]{~\textcolor{green}{\bm{a}}~}_{\text{source spectrum}} + \underbracket[0.5pt]{~\textcolor{red}{\bm{n}}~}_{\text{Gaussian noise}} $$
	}
	\only<2->{
	$$\Big\langle \underbracket[0.5pt]{~\bm{p}~}_{\text{measured spectra}} =\underbracket[0.5pt]{~\textcolor{green}{\bm{a}}~}_{\text{source spectrum}} + \underbracket[0.5pt]{~\textcolor{red}{\bm{n}}~}_{\text{Gaussian noise}}  \Big\rangle_{\text{\normalsize $ N_s$ snapshots}}$$
	}
	\end{overlayarea}
	
	\onslide<2->{\textbf{Cross-Spectral Matrix} (covariance of Fourier component):
	$$\bm{S}_{pp} = \frac{1}{N_s} \sum_i  \bm{p}_i\bm{p}_i^H$$
	}
	
	\begin{itemize}
		\item<3-> Hermitian (conjugate symmetric)
		\item<4-> Positive semidefinite (nonnegative eigenvalues)
	\end{itemize}~\\
	

	\onslide<5->{
	$$\underbracket[0.5pt]{~\bm{S}_{pp}~}_{\text{measured CSM}} =\underbracket[0.5pt]{ ~\textcolor{green}{\bm{S}_{aa}}~}_{\text{signal of interest}} +\underbracket[0.5pt]{~\textcolor{red}{\bm{S}_{nn}}~}_{\text{unwanted noise}} + \underbracket[0.5pt]{~\bm{S}_{an}+\bm{S}_{na}}_{\text{cross-terms}}$$
	
	\begin{itemize}	
		\item Rank of $\bm{S}_{aa}=$ number of uncorrelated monopoles
	\end{itemize}
	}
\end{frame}

\begin{frame}{\insertsectionhead~--~CSM properties}
	\begin{overlayarea}{\textwidth}{3cm}

		\only<1>{$$\underbracket[0.5pt]{~\bm{S}_{pp}~}_{\text{measured CSM}} =\underbracket[0.5pt]{ ~\textcolor{green}{\bm{S}_{aa}}~}_{\text{signal of interest}} +\underbracket[0.5pt]{~\textcolor{red}{\bm{S}_{nn}}~}_{\parbox[t]{2cm}{\centering \text{\scriptsize unwanted noise}}} + \underbracket[0.5pt]{~\bm{S}_{an}+\bm{S}_{na}}_{\parbox[t]{2cm}{\centering \text{\scriptsize cross-terms}}}$$
		}
		
		\only<2>{$$\underbracket[0.5pt]{~\bm{S}_{pp}~}_{\text{measured CSM}} =\underbracket[0.5pt]{ ~\textcolor{green}{\bm{S}_{aa}}~}_{\text{signal of interest}} +\underbracket[0.5pt]{\bcancel{~\textcolor{red}{\bm{S}_{nn}}~}}_{\parbox[t]{2cm}{\centering \text{\scriptsize unwanted noise} \\ $\approx \diag{\textcolor{red}{\sigma^2}}$ }} + \underbracket[0.5pt]{~\bm{S}_{an}+\bm{S}_{na}}_{\parbox[t]{2cm}{\centering \text{\scriptsize cross-terms}}}$$
		}
	
		\only<3>{$$\underbracket[0.5pt]{~\bm{S}_{pp}~}_{\text{measured CSM}} =\underbracket[0.5pt]{ ~\textcolor{green}{\bm{S}_{aa}}~}_{\text{signal of interest}} +\underbracket[0.5pt]{\bcancel{~\textcolor{red}{\bm{S}_{nn}}~}}_{\parbox[t]{2cm}{\centering \text{\scriptsize unwanted noise} \\ $\approx \diag{\textcolor{red}{\sigma^2}}$ }} + \underbracket[0.5pt]{\bcancel{~\bm{S}_{an}+\bm{S}_{na}}}_{\parbox[t]{2cm}{\centering  \text{\scriptsize cross-terms}\\ $\rightarrow 0$ }}$$
		}
	
	\end{overlayarea}
	
	\hspace{0.8cm}\textbf{For $N_s \rightarrow \infty$}\\
	\pause
	\begin{itemize}
		\setlength{\itemindent}{1cm}
		\item Short correlation length : off-diagonal elements of $S_{nn}\rightarrow 0$
		\pause
		\item Independent signal/noise : cross-terms $\rightarrow 0$
	\end{itemize}
	%$$\bm{S}_{pp} \approx \textcolor{green}{\bm{S}_{aa}} + \diag	{\textcolor{red}{\sigma^2}}$$

\end{frame}


%%% Plan
%======================
\begin{frame}{How to separate signal part from noise ?}
	 
	
	\begin{itemize}
	%\setlength{\itemindent}{0.5cm}
		\item Existing methods:
			\begin{itemize}
			        \item 	3 diagonal reconstruction methods
		        		\item Robust Principal Component Analysis (RPCA)
			\end{itemize}
			
		\vfill\pause
	
		\item Proposed method:
			\begin{itemize}
       			 	\item PFA
			\end{itemize}

		\vfill \pause
		\item What is the influence on denoising performance of : 
		\begin{itemize}
		        \item noise level,
		        \item number of snapshots,
		        \item number of sources ?
		\end{itemize}
	\end{itemize}
\end{frame}


%%% Diagonal reconstruction
%======================
\section{Diagonal Reconstruction}
\begin{frame}
\tableofcontents[hideallsubsections]
\end{frame}
\begin{frame}
\tableofcontents[currentsection,hideothersubsections]
\end{frame}


\begin{frame}{\insertsectionhead}	
\textit{''Remove as much noise as possible as long as denoised CSM remains positive''}
	\begin{block}{Convex optimization   \citeTransp{Hald2017}}<1->
		\begin{equation*}
        			\text{maximize~} \| \bm{\sigma}_{n}^2\|_1 \text{~~subject to~~} \bm{S}_{pp}- \diag{\bm{\sigma}_n^2} \geq 0
		\end{equation*}
		Problem solved with CVX Matlab toolbox.
	\end{block}
	\begin{block}{Linear optimization \citeTransp{dougherty2016}}<2->
		\vspace{-0.2cm}
		\begin{equation*}
			\text{maximize~} \| \bm{\sigma}_{n}^2\|_1   \text{~~subject to~~}  \bm{V}^{H}_{(k-1)} \left( \bm{S}_{pp}- \diag{\bm{\sigma}_n^2}_{(k)} \right) \bm{V}_{(k-1)} \geq 0 
		\end{equation*}
		 $\bm{V}_{(k-1)}$: eigenvectors of $\bm{S}_{pp}-\diag{\bm{\sigma}_n^2}_{(1,...,k-1)} $\\[1pt]
		Solved with \textit{linprog} Matlab function .
	\end{block}
	\begin{block}{Alternating Projections  \citeTransp{leclere:hal-01279944}}<3->
		\begin{equation*}
        			 \bm{S}_{{pp}_{(k+1)}} := \bar{\bm{S}}_{{pp}_{(0)}} + \bm{V}^{H}_{(k)} \bm{s}_{(k)}^{\textcolor{red}{\textbf{+}}}\bm{V}^{~}_{(k)}
		\end{equation*}
		$\bm{V}^{H}_{(k)}$ and $\bm{s}_{(k)}$: eigenvectors/values of  $\bm{S}_{{pp}_{(k)}}$.\\[1pt]
	\end{block}	
\end{frame}

%%% Test case
\subsection{Comparison on a test case}
\begin{frame}{\insertsectionhead}
	
	\begin{itemize}
	\item Default parameters:
		\noindent\begin{minipage}{\linewidth}
		     	\begin{minipage}{0.4\linewidth}		     		
	         			\begin{itemize}
					\item 20  uncorrelated free field monopoles: \textcolor{red}{$\vcenter{\hbox{\tiny$\blacklozenge$}}$}
					\item 93 receivers: \textcolor{colorAlice}{$\vcenter{\hbox{\small$\bm{\circ}$}}$}
					\item SNR: 10 dB
					\item $10^4$ snapshots
					\item frequency: 15 kHz
				\end{itemize}	
	               		\vfill
	     		\end{minipage}
	      		%\hspace{0.02\linewidth}
	      		\hfill
	     		 \begin{minipage}{0.5\linewidth}
             			\centering
             			\vspace{-0.5cm}
				\input{img/config.tex}
	      		\end{minipage}
		\end{minipage}
	
	\item Varying parameters: \\
	\begin{itemize}
	        \item number of   \textcolor{red}{$\vcenter{\hbox{\tiny$\blacklozenge$}}$} (rank of $\bm{S}_{aa}$) : from 1 to 93\\[3pt]
	        \item SNR from -10 to 10 dB\\[3pt]
	        \item Number of snapshots (level of extra-diagonal terms): from 10 to $5.10^4$
\end{itemize}~\\	
	
	\item Error on the signal CSM:
	\begin{equation*}
   		 \delta = \frac{\|\diag{\bm{S}_{aa}}  - \diag{\bm{\hat{S}}_{aa}}\|_2}{\|\diag{\bm{S}_{aa} } \|_2}
	\end{equation*}
	\end{itemize}

\end{frame}


\begin{frame}{\insertsectionhead}

	%default values
	Default values:
    \setlength\extrarowheight{3pt}
	\begin{tabular}{|c|c|c|c|c|}
	\hline
	 20  sources & 93 receivers & SNR: 10 dB & $10^4$ snapshots & frequency: 15 kHz	\\ \hline
	\end{tabular}
	\vfill


	%legend
%	\begin{mdframed}[
%		linecolor=black,%
%		innertopmargin =0.2cm,
%		innerbottommargin =0.2cm,
%		innerrightmargin =0.1cm,
%		innerleftmargin =0.1cm,
%		roundcorner=1pt
%		%usetwoside=true,
%		]		
		\definecolor{mycolor1}{rgb}{0.00000,0.44700,0.74100}%
		\definecolor{mycolor2}{rgb}{0.92900,0.69400,0.12500}%
		\definecolor{mycolor3}{rgb}{0.46600,0.67400,0.18800}%
		{\footnotesize \tikz[baseline=-1pt]\draw[line width=1.0pt,color=mycolor1](0,.5ex)--++(.5,0) ; Convex optimization \hfill
		\tikz[baseline=-1pt]\draw[color=mycolor2,line width=1.0pt] (0,.5ex)--++(.5,0) ; Alternating~projections\hfill
		 \tikz[baseline=-1pt]\draw[color=mycolor3,line width=1.0pt] (0,.5ex)--++(.5,0) ; Linear~optimization}
%	\end{mdframed}
	
	\resizebox{1.05\textwidth}{!}{
	\begin{minipage}{1.2\textwidth}
		\centering
		\hspace{-1cm}\input{img/diagonal_reconstruction/AP_rang.tex}
		\hspace{-0.2cm}\input{img/diagonal_reconstruction/AP_SNR.tex}
		\hspace{-0.4cm}\input{img/diagonal_reconstruction/AP_Mw.tex}
	\end{minipage}
	}
	\begin{block}{Select Convex Optimization (DRec) for further comparison}
		\ding{51} Fast, simple code		 \hfill\parbox{0.5\linewidth}{\ding{55} Local optimization}\\
		\ding{51} Better performance		 \hfill\parbox{0.5\linewidth}{\ding{55} Denoises only auto-spectra}\\
	\end{block}

\end{frame}

%%% RPCA
%======================
\section{RPCA}
\begin{frame}
\tableofcontents[currentsection,hideothersubsections]
\end{frame}
\begin{frame}{\insertsectionhead}
	\vspace{-0.5cm}
	\begin{center}
		\textit{''Search $\bm{S}_{aa}$ as a low rank matrix and $\bm{S}_{nn}$ as a sparse matrix''}\\~\\
		\colorbox{gray!20}{
		 $\text{minimize~} \|\textcolor{green}{\bm{{S}}_{aa}} \|_* + \lambda \| \textcolor{red}{\bm{{S}}_{nn}} \|_1  \text{~~~~subject to~~~~} \textcolor{green}{ \bm{{S}}_{aa}} +  \textcolor{red}{\bm{{S}}_{nn} = \bm{S}_{pp}}$
		}
	\end{center}


	
	$\| \cdot \|_*$: nuclear norm (related to rank)\\
	$\| \cdot \|_1$: $\ell_1$-norm (related to sparsity)\\~\\
	
	Solved with a proximal gradient algorithm.
	\vfill

	\begin{block}{RPCA  \citeTransp{Wright2009a}}
		\ding{51} Modifies the whole CSM		\hfill\parbox{0.57\linewidth}{\ding{55} Local optimization}\\[2pt]
		~\hfill\parbox{0.57\linewidth}{\ding{55} Choose regularization parameter:
		\small
		\begin{itemize}
			\setlength{\itemindent}{0.3cm}
		        \item[-] L-curve criterion,\\[-2pt]
		        \item[-] Generalized cross validation method,\\[-2pt]
		       \item[-] Bayesian criterion, \dots
		\end{itemize}
		}
	\end{block}
	\vfill
	\begin{tabular}{rl}
	$\hookrightarrow$ For comparison :& - optimal $\lambda$  (unknown on real case)\\
	& - ''universal'' constant  parameter $\lambda=M^{-\frac{1}{2}}=0.1$
	\end{tabular}

\end{frame}

%%% PFA
%======================
\section{Probabilistic Factor Analysis}
\begin{frame}
\tableofcontents[currentsection,hideothersubsections]
\end{frame}

\begin{frame}{\insertsectionhead}

	\begin{itemize}
        		\item<1-> \textbf{Latent variable model}\\~\\       		
        		
        		\begin{tikzpicture}[remember picture]
			\colorbox{gray!20}{$\tikzmark{p}\bm{p} = \tikzmark{L}\textcolor{blue}{\bm{L}} \tikzmark{c}\textcolor{green}{\bm{c}} + \tikzmark{n}\textcolor{red}{\bm{n}}$}
			
			%p
			\node (pdescr) [below left=-0.5cm and 1cm of p, align=center]{
				\footnotesize observable\\[-3pt] \footnotesize variables
			};
			\draw[->,>=stealth] (pdescr) -- ($(p.east)+(-7pt,6pt)$);
			
			% L
			\node(Ldescr) [below left=0.3cm and 0.5cm of L,align=center] {
				\footnotesize matrix of\\[-3pt] \footnotesize loading factors
			};
	    		%\draw[] (Ldescr.east) to [in=-90,out=45]  (L.south) ;
	    		\draw[->,>=stealth] ($(Ldescr.east)+(-5pt,5pt)$) to ($(L)+(-2pt,0)$);
	    		
	    		% c
	    		\node(cdescr) [below right  =0.3cm  and 0.1cm of c , align=center]{
	    			\footnotesize latent\\[-3pt] \footnotesize factors
	    		};
	    		\draw[->,>=stealth] (cdescr) to ($(c.south)+(2pt,0)$);
	    		
	    		% n
	    		\node(ndescr) [below right=0.2cm and 1cm of n,align=center]{
	    			\footnotesize error (noise)
	    		};
	    		\draw[->,>=stealth] (ndescr) to ($(n)+(5pt,2pt)$);
		\end{tikzpicture}
		\pause
		\begin{itemize}
		        \item Capture dominant correlation with fewer parameters (close to PCA) \pause
		        \item Extract anisotropic noise\\[6pt] \pause
		\end{itemize}
	\end{itemize}

        		\vfill
        	\begin{overlayarea}{\textwidth}{0.5\textheight}
        	\only<4-7>{
	\begin{itemize}        		
        		\item \textbf{Statistical inference: } See parameters as random variables
        		\vspace{-0.2cm}\begin{multicols}{3}
		\hspace{0.5cm}$\textcolor{blue}{\bm{L}}\sim\mathcal{N}_{\mathbb{C}}(0,\bm{\gamma}^2)$\\
		\hspace{0.2cm}$\textcolor{green}{\bm{c}}\sim\mathcal{N}_{\mathbb{C}}(0,\bm{I\alpha}^2)$\\
		\hspace{0.2cm}$\textcolor{red}{\bm{n}}\sim\mathcal{N}_{\mathbb{C}}(0,\bm{I\sigma}^2)$\\
		\end{multicols}
		\pause
		\vspace{-0.2cm}+ non-informative priors : $\bm{\gamma}^2, \bm{\alpha}^2, \bm{\sigma}^2\sim\mathcal{IG}(a_{\gamma,\alpha,\sigma},b_{\gamma,\alpha,\sigma})$\\[6pt]      	
		\pause			 
        		\vfill
        		
        		\item \textbf{Solved using MCMC algorithm} (Gibb's sampling)\\
		Iteratively draws in the marginal conditional distribution of each parameter\\[6pt]
		\pause		
        		\vfill        		
        		\item \textbf{Finally}, signal CSM:\\[-0.5cm]
        		 $$\bm{\hat{S}}_{aa}=\frac{1}{N_s}\sum_{i=1}^{N_s}\bm{L}\bm{c}_i\bm{c}^H_i\bm{L}^H$$        
        		 \vspace{-3cm}
		 
	\end{itemize}
	}
	
	\only<8->{
	\begin{block}{PFA}
		\ding{51} Global optimization \hfill\parbox{0.5\linewidth}{\ding{55} Computationally expensive}\\
		\ding{51} Flexible model
	\end{block}~\\
	}
	\end{overlayarea}	

\end{frame}

%\begin{frame}{\insertsectionhead}
%	\begin{itemize}
%	        \item 	Gibbs sampling in the Bayesian hierarchical model : \\[.5cm]
%		\hspace{-1.7cm}\begin{tikzpicture}[remember picture]
%			$\bm{p} = \tikzmark{L}\bm{L}   \tikzmark{c}\bm{c} + \tikzmark{n}\bm{n}$
%			
%			% L
%			\node(Ldescr) [below left=0.5cm and 2cm of L,align=center] {
%				Loading factors\\
%				$\bm{L}\sim\mathcal{N}_{\mathbb{C}}(0,\bm{\gamma}^2)$
%			};
%	    		%\draw[] (Ldescr.east) to [in=-90,out=45]  (L.south) ;
%	    		\draw[] (Ldescr.east)++(0,10pt) to [in=-130,out=45] (L);
%	    		
%	    		% c
%	    		\node(cdescr) [below  =0.5cm  of c,align=center]{
%	    			Latent variables\\
%	    			$\bm{c}\sim\mathcal{N}_{\mathbb{C}}(0,\bm{I\alpha}^2)$
%	    		};
%	    		\draw (cdescr.north) to (c.south);
%	    		
%	    		% n
%	    		\node(ndescr) [below right=0.5cm and 2cm of n,align=center]{
%	    			Uncorrelated noise\\
%	    			$\bm{n}\sim\mathcal{N}_{\mathbb{C}}(0,\bm{I\sigma}^2)$
%	    		};
%	    		\draw (ndescr.west)++(0,10pt) to [in=-40,out=135] (n.east)++(0,2pt);
%		\end{tikzpicture}
%		\item Hyperparameters:\\[-7pt]
%		\begin{multicols}{3}
%		\hspace{0.5cm}$\bm{\gamma}^2\sim\mathcal{IG}(a_{\gamma},b_{\gamma})$\\
%		\hspace{0.2cm}$\bm{\alpha}^2\sim\mathcal{IG}(a_{\alpha},b_{\alpha})$\\
%		\hspace{0.2cm}$\bm{\sigma}^2\sim\mathcal{IG}(a_{\sigma},b_{\sigma})$\\
%		\end{multicols}
%		
%		\item Signal CSM : 		$$\bm{\hat{S}}_{aa}=\frac{1}{N_s}\bm{L} \left(\sum_{i=1}^{N_s}\bm{c}_i\bm{c}^H_i\right) \bm{L}^H$$
%	
%	\end{itemize}
%		
%	\begin{block}{PFA}
%		\ding{51} Global optimization \hfill\parbox{0.5\linewidth}{\ding{55} Computationally expensive}\\
%		\ding{55} Here, model for uncorrelated noise $\bm{\rightarrow}$ \ding{51} but flexible
%	\end{block}~\\
%	
%	
%	%How to fix number of factor $\kappa$ ?
%	%	Enforce sparsity on factors $\rightarrow$ will set useless factors will be set to zero
%\end{frame}

%%% Comparison
%======================
\section{Comparison}
\begin{frame}
\tableofcontents[currentsection,hideothersubsections]
\end{frame}
\begin{frame}{\insertsectionhead}
	%\vspace{-0.1cm}
	%legend
%	\begin{mdframed}[
%		linecolor=black,%
%		innertopmargin =0.05cm,
%		innerbottommargin =0cm,
%		innerrightmargin =0.1cm,
%		innerleftmargin =0.1cm,
%		roundcorner=1pt
%		%usetwoside=true,
%		]
		\definecolor{hald}{rgb}{0.00000,0.44700,0.74100}%
		\definecolor{rpca}{rgb}{0.85000,0.32500,0.09800}%
		\definecolor{mcmc}{rgb}{0.49400,0.18400,0.55600}%
		{\footnotesize \tikz[baseline=-1.5pt]{\draw[line width=1.0pt,color=hald] (0,.5ex)--++(.5,0) ;} DRec \hfill
			\tikz[baseline=-1.5pt]{\draw[dashed,line width=1.0pt , color=rpca] (0,.5ex)--++(.5,0) ;} RPCA, $\lambda_{opt}$ \hfill
			\tikz[baseline=-1.5pt]{\draw[line width=1.0pt , color=rpca] (0,.5ex)--++(.5,0) ;} RPCA, $\lambda=M^{-\frac{1}{2}}$ \hfill
			\tikz[baseline=-1.5pt]{\draw[line width=1.0pt , color=mcmc] (0,.5ex)--++(.5,0) ;} PFA}
%		\end{mdframed}
	\vspace{0.2cm}
	\begin{itemize}
		\item<1-> 	{\small \bfseries Homogeneous noise\\}	
		\begin{overprint}
		\begin{center}
			\resizebox{0.9\textwidth}{!}{
				\begin{minipage}{1.2\textwidth}
					\centering		
					\hspace{-1cm}\input{img/comparison/all_homo_rang.tex}
					\hspace{-0.2cm}\input{img/comparison/all_homo_SNR.tex}
					\hspace{-0.4cm}\input{img/comparison/all_homo_Mw.tex}
				\end{minipage}
			}
		\end{center}
		\end{overprint}

		\pause	
	\only<2-4>{
		\vspace{1cm}
		 \begin{itemize}
		 \setlength{\itemindent}{0.5cm}
		 	\item[$\hookrightarrow$] For $N_{src} \geq 0.75 M$: denoising problem becomes poorly conditioned       \\[5pt] \pause
       		 	\item[$\hookrightarrow$] Error linearly decreases with increasing SNR\\[5pt] \pause
       		 	\item[$\hookrightarrow$] Error linearly decreases with logarithmically increasing $N_s$\\[5pt] \pause
       		\end{itemize}
	}	
		\item<5-> 	{\vspace{4pt} \small {\bfseries Heterogeneous noise}: SNR 10 dB lower on 10 random receivers\\}
		\begin{center}		
			\resizebox{0.9\textwidth}{!}{
				\begin{minipage}{1.2\textwidth}	
					\centering	
					\hspace{-1cm}\input{img/comparison/all_hetero_rang_carree.tex}
					\hspace{-0.2cm}\input{img/comparison/all_hetero_SNR.tex}
					\hspace{-0.4cm}\input{img/comparison/all_hetero_Mw.tex}
				\end{minipage}
			}
		\end{center}
			%\caption{Relative error $\delta$ on the diagonal of the signal CSM. Denoising methods: DRec~(\protect\tikz[baseline]\protect\draw[line width=1.0pt,color=hald] (0,.5ex)--++(.5,0) ;), RPCA with $\lambda_{opt}$~(\protect\tikz[baseline]\protect\draw[dashed,line width=1.0pt , color=rpca] (0,.5ex)--++(.5,0) ;),
			%	RPCA with $\lambda=M^{-\frac{1}{2}}$~(\protect\tikz[baseline]\protect\draw[line width=1.0pt , color=rpca] (0,.5ex)--++(.5,0) ;) and
			%	PFA~(\protect\tikz[baseline]\protect\draw[line width=1.0pt , color=mcmc] (0,.5ex)--++(.5,0) ;).
			%	(a,b,c) Noise is added homogeneously to the 93 receivers.	 (d,e,f) Noise is 10~dB higher on 10 random receivers. When one parameter varies, the other are constant, given by %Tab.~\ref{default_values}.
			%}
	\end{itemize}
\end{frame}

%%% Conclusion
%==================
\section*{Conclusion}
\begin{frame}{\insertsectionhead}
	\begin{itemize}
		\item DRec: fast and simple but error at least 5 dB higher for rank under 70\\
		\vfill
		\pause
		\item PFA 
		\begin{itemize}
		        \item performance similar to RPCA using $\lambda_{opt}$
			\item PFA and RPCA more robust to heterogeneous noise	
			\item flexible model $\rightarrow$ to be adapted for correlated noise	
		\end{itemize}
		\vfill \pause
		\item Choose your denoising method according to the expected number of sources\\[10pt]
		\vfill			
		\noindent\hspace{-1cm}\begin{minipage}{1.1\textwidth}
			\begin{minipage}{0.72\textwidth}
				\centering
				\begin{tikzpicture}
			   		\node[anchor=south west] (image) at (0,0) {\input{img/comparison/all_hetero_rang_large.tex}};
					\begin{scope}[x={(image.south east)},y={(image.north west)}]
			       			\pause
			       			\draw[thick] (0.33,0.1) to (0.33,1.05);
			       			\node at (0.25,1) {RPCA};
			       			\pause
			       			\draw[thick] (0.75,0.1) to (0.75,1.05);
			       			\node at (0.54,1) {PFA};
			       			\pause
			       			\node at (0.88,1) {DRec};
			   		 \end{scope}
				\end{tikzpicture}
			\end{minipage}	
			\hfill
			\begin{minipage}{0.25\textwidth}
				\definecolor{hald}{rgb}{0.00000,0.44700,0.74100}%
				\definecolor{rpca}{rgb}{0.85000,0.32500,0.09800}%
				\definecolor{mcmc}{rgb}{0.49400,0.18400,0.55600}%
				{\footnotesize \tikz[baseline=-1.5pt]{\draw[line width=1.0pt,color=hald] (0,.5ex)--++(.5,0) ;} DRec\\[5pt]
					\tikz[baseline=-1.5pt]{\draw[dashed,line width=1.0pt , color=rpca] (0,.5ex)--++(.5,0) ;} RPCA, $\lambda_{opt}$\\[5pt]
					\tikz[baseline=-1.5pt]{\draw[line width=1.0pt , color=rpca] (0,.5ex)--++(.5,0) ;} RPCA, $\lambda=M^{-\frac{1}{2}}$\\[5pt]
					\tikz[baseline=-1.5pt]{\draw[line width=1.0pt , color=mcmc] (0,.5ex)--++(.5,0) ;} PFA}
			\end{minipage}		
		\end{minipage}		
	\end{itemize}
\end{frame}


\appendix
\begin{frame}{References}
	%\begin{adjustwidth}{-2em}{-2.5em}
		\setlength{\bibsep}{18pt}
		\bibliographystyle{abbrvnat}
		\bibliography{biblio}
	%\end{adjustwidth}
\end{frame}


%Texte du diapo \cite{Solomaa1973} et \cite{Dijkstra1982}
%\vfill
% 
%{\tiny 
%\usebibitemtemplate{\color{black}\insertbiblabel} 
%\usebibliographyblocktemplate{\color{black}}{\color{black}}{\color{black}}{\color{black}} 
% 
%\begin{thebibliography}{} 
%\bibitem{Solomaa1973} 
%A.~Salomaa. 
%\newblock {\em Formal Languages}. 
%\newblock Academic Press, 1973. 
%\bibitem{Dijkstra1982} 
%E.~Dijkstra. 
%\newblock Smoothsort, an alternative for sorting in situ. 
%\newblock {\em Science of Computer Programming}, 1(3):223--233, 1982. 
%\end{thebibliography} }


\end{document}